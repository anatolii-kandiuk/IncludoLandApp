{% load static %}
<!doctype html>
<html lang="uk">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>–ó–≤—É–∫–∏ ‚Äî –ü—Ä–æ—Ñ—ñ–ª—å —Å–ø–µ—Ü—ñ–∞–ª—ñ—Å—Ç–∞</title>
    <link rel="stylesheet" href="{% static 'css/home.css' %}">
    <link rel="stylesheet" href="{% static 'css/specialist.css' %}">
    <link rel="stylesheet" href="{% static 'css/specialist_sounds.css' %}">
    <script src="{% static 'js/specialist_sounds.js' %}" defer></script>
    <link rel="stylesheet" href="{% static 'css/responsive.css' %}">
</head>

<body>
    <div class="shell">
        {% include 'includes/specialist_sidebar.html' with active='sounds' %}

        <main class="main">
            <header class="top">
                <div class="top__left"></div>
                <div class="top__right">
                    <div class="chip chip--user">
                        <span class="chip__avatar" aria-hidden="true">üë©‚Äçüè´</span>
                        <span class="chip__text">{{ username }}</span>
                    </div>
                </div>
            </header>

            <section class="content">
                <div class="page-title">
                    <h1 class="page-title__h" id="form-title">–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π –∑–≤—É–∫</h1>
                </div>

                <div class="sound-builder">
                    <form class="sound-form" id="sound-form" method="post" enctype="multipart/form-data"
                        action="{% url 'specialist_sounds' %}" data-create-action="{% url 'specialist_sounds' %}"
                        data-edit-url-template="{% url 'specialist_sound_edit' 0 %}"
                        data-edit-card-id="{% if edit_card_id %}{{ edit_card_id }}{% endif %}">
                        {% csrf_token %}

                        <div class="current current--hidden" id="current-media" aria-label="–ü–æ—Ç–æ—á–Ω—ñ —Ñ–∞–π–ª–∏">
                            <div class="current__meta">
                                <div class="current__label">–ü–æ—Ç–æ—á–Ω–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è:</div>
                                <div class="current__thumb" id="current-thumb"></div>
                            </div>
                            <div class="current__meta">
                                <div class="current__label">–ü–æ—Ç–æ—á–Ω–∏–π –∑–≤—É–∫:</div>
                                <audio class="current__audio" id="current-audio" controls></audio>
                            </div>
                        </div>

                        <label class="drop" for="id_image">
                            <input class="drop__input" id="id_image" name="image" type="file" accept="image/*">
                            <span class="drop__box">
                                <span class="drop__icon" aria-hidden="true">üñºÔ∏è</span>
                                <span class="drop__text" id="drop-text">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è</span>
                            </span>
                        </label>

                        <input class="sound-input" id="id_title" name="title" type="text" maxlength="80"
                            placeholder="–ü—ñ–¥–ø–∏—Å –¥–æ –∫–∞—Ä—Ç–∏–Ω–∫–∏" required value="{{ form.title.value|default:'' }}">

                        <label class="audio" for="id_audio">
                            <input class="audio__input" id="id_audio" name="audio" type="file" accept="audio/*">
                            <span class="audio__btn" id="audio-btn-text">–í–∏–±—Ä–∞—Ç–∏ –∞—É–¥—ñ–æ—Ñ–∞–π–ª</span>
                        </label>

                        <button class="save" id="save-btn" type="submit">–ó–±–µ—Ä–µ–≥—Ç–∏ –∫–∞—Ä—Ç–∫—É</button>
                        <button class="cancel cancel--hidden" id="cancel-edit" type="button">–°–∫–∞—Å—É–≤–∞—Ç–∏
                            —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è</button>

                        {% if form.errors %}
                        <div class="form-errors" role="alert">
                            {{ form.errors }}
                        </div>
                        {% endif %}
                    </form>

                    <aside class="preview" aria-label="–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥">
                        <div class="preview__title">–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥</div>
                        <div class="preview-card" id="preview-card">
                            <div class="preview-card__img" id="preview-img"></div>
                            <div class="preview-card__label" id="preview-label">‚Äî</div>
                            <button class="preview-card__play" id="preview-play" type="button" disabled
                                aria-label="–í—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏">
                                ‚ñ∂
                            </button>
                            <audio id="preview-audio"></audio>
                        </div>
                    </aside>
                </div>

                {% if cards %}
                <div class="library">
                    <h2 class="library__title">–ú–æ—ó –¥–æ–¥–∞–Ω—ñ –∑–≤—É–∫–∏</h2>
                    <div class="library__grid" aria-label="–°–ø–∏—Å–æ–∫ –∑–≤—É–∫—ñ–≤">
                        {% for c in cards %}
                        <div class="lib-card" data-card-id="{{ c.id }}" data-title="{{ c.title|escape }}"
                            data-image-url="{{ c.safe_image_url }}" data-audio-url="{{ c.safe_audio_url }}"
                            role="button" tabindex="0" aria-label="–†–µ–¥–∞–≥—É–≤–∞—Ç–∏: {{ c.title|escape }}">
                            <div class="lib-card__img" {% if c.safe_image_url %}data-bg-image="{{ c.safe_image_url }}"
                                {% endif %}></div>
                            <div class="lib-card__label">{{ c.title }}</div>
                            <div class="lib-card__actions">
                                <button class="lib-card__play" type="button" data-audio-url="{{ c.safe_audio_url }}" 
                                {% if not c.safe_audio_url %}disabled title="–§–∞–π–ª –∑–≤—É–∫—É –≤—ñ–¥—Å—É—Ç–Ω—ñ–π" {% endif %}>‚ñ∂</button>
                                <button class="lib-card__btn lib-card__edit" type="button"
                                    aria-label="–†–µ–¥–∞–≥—É–≤–∞—Ç–∏">‚úé</button>
                                <form class="lib-card__delete" method="post"
                                    action="{% url 'specialist_sound_delete' c.id %}">
                                    {% csrf_token %}
                                    <input type="hidden" name="next" value="{% url 'specialist_sounds' %}">
                                    <button class="lib-card__btn lib-card__btn--danger" type="submit"
                                        data-confirm="–í–∏–¥–∞–ª–∏—Ç–∏ –∫–∞—Ä—Ç–∫—É ¬´{{ c.title|escapejs }}¬ª?"
                                        aria-label="–í–∏–¥–∞–ª–∏—Ç–∏">üóë</button>
                                </form>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </section>
        </main>
    </div>
    {% include 'includes/footer.html' %}
</body>

</html>